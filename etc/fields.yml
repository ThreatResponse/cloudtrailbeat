version: 1.0

defaults:
  type: string
  required: false
  index: not_analyzed
  doc_values: true
  ignore_above: 1024

env:
  type: group
  description: >
    Contains common fields available in all event types.
  fields:
    - name: beat.name
      description: >
        The name of the Beat sending the log messages. If the shipper name is set
        in the configuration file, then that value is used. If it is not set,
        the hostname is used.

    - name: beat.hostname
      description: >
        The hostname as returned by the operating system on which the Beat is
        running.

    - name: "@timestamp"
      type: date
      required: true
      format: YYYY-MM-DDTHH:MM:SS.milliZ
      example: 2015-01-24T14:06:05.071Z
      description: >
        The timestamp when the HTTP url was called. The precision is in
        milliseconds. The timezone is UTC.

    - name: type
      required: true
      description: >
        The name of the log event. This field is set to the value specified for the `document_type` option in the url section of the Execbeat config file.

    - name: fields
      type: dict
      required: false
      description: >
        Contains user configurable fields.

cloudtrail:
  type: group
  description: >
    Contains information about a CloudTrail event
  fields:
    - name: cloudtrail
      type: group
      description: >
          Contains CloudTrail access logs.

      fields:
        - name: eventTime
          type: string
          description: >
            The date and time the request was made, in coordinated universal time (UTC).

        - name: eventVersion
          type: string
          description: >
            The version of the log event format. The current version is 1.02.
    
        - name: userIdentity
          type: string
          description: >
            Information about the user that made a request. For more information, see CloudTrail userIdentity Element 
    
        - name: eventSource
          type: string
          description: >
            The service that the request was made to. This name is normally a short form of the service name without spaces plus .amazonaws.com. For example, the eventSource field lists a call to AWS CloudFormation as cloudformation.amazonaws.com, a call to Amazon EC2 as ec2.amazonaws.com, and a call to Amazon Simple Workflow Service as swf.amazonaws.com. One exception to this convention is CloudWatch, for which the event source is monitoring.amazonaws.com.
    
        - name: eventName
          type: string
          description: >
            The requested action, which is one of the actions listed in the API Reference for the service.
    
        - name: awsRegion
          type: string
          description: >
            The AWS region that the request was made to; for example, us-east-1.
    
        - name: sourceIPAddress
          type: string
          description: >
            The apparent IP address that the request was made from. For actions that originate from the service console, the address reported is for the underlying customer resource, not the console web server. For services in AWS, only the DNS name is displayed.
    
        - name: errorCode
          type: string
          description: >
            The AWS service error if the request returns an error.
    
        - name: errorMessage
          type: string
          description: >
            If the request returns an error, the description of the error. This message includes messages for authorization failures.
    
        - name: requestParameters
          type: string
          description: >
            The parameters, if any, that were sent with the request.
    
        - name: responseElements
          type: string
          description: >
            The response element for actions that make changes (create, update, or delete actions). If an action does not change state (for example, a request to get or list objects), this element is omitted.
    
        - name: requestID
          type: string
          description: >
            Value generated by the service being called that identifies the request.
    
        - name: eventID
          type: string
          description: >
            GUID generated by CloudTrail to uniquely identify each event. You can use this value to identify a single event. For example, you can use the ID as a primary key to retrieve log data from a searchable database.
    
        - name: eventType
          type: string
          description: >
            Identifies the type of event that generated the event record.
    
        - name: apiVersion
          type: string
          description: >
            Identifies the API version number associated with the AwsApiCall eventType value.
    
        - name: recipientAccountID
          type: string
          description: >
            Represents the account ID that received this event.
    
